using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace PyDoodle
{
    public class TweakControl : UserControl
    {
        //-///////////////////////////////////////////////////////////////////////
        //-///////////////////////////////////////////////////////////////////////

        public class EventArgs : System.EventArgs
        {
            //-///////////////////////////////////////////////////////////////////////
            //-///////////////////////////////////////////////////////////////////////

            private object _value;

            //-///////////////////////////////////////////////////////////////////////
            //-///////////////////////////////////////////////////////////////////////

            public object Value
            {
                get { return _value; }
            }

            //-///////////////////////////////////////////////////////////////////////
            //-///////////////////////////////////////////////////////////////////////

            public EventArgs(object value)
            {
                _value = value;
            }

            //-///////////////////////////////////////////////////////////////////////
            //-///////////////////////////////////////////////////////////////////////
        }

        //-///////////////////////////////////////////////////////////////////////
        //-///////////////////////////////////////////////////////////////////////

        public delegate void TweakHandler(object sender, EventArgs ea);
        public TweakHandler Tweak;

        public EventHandler EnterPressed;

        //-///////////////////////////////////////////////////////////////////////
        //-///////////////////////////////////////////////////////////////////////

        protected void OnTweak(EventArgs ea)
        {
            if (Tweak != null)
                Tweak(this, ea);
        }

        //-///////////////////////////////////////////////////////////////////////
        //-///////////////////////////////////////////////////////////////////////

        public delegate TweakControl Creator();

        //-///////////////////////////////////////////////////////////////////////
        //-///////////////////////////////////////////////////////////////////////

        public static TweakControl CreateTweakControl<T>() where T : TweakControl, new()
        {
            return new T();
        }

        //-///////////////////////////////////////////////////////////////////////
        //-///////////////////////////////////////////////////////////////////////

        public virtual void SetValue(dynamic newValue)
        {
        }

        //-///////////////////////////////////////////////////////////////////////
        //-///////////////////////////////////////////////////////////////////////

        // http://www.codeproject.com/Articles/36648/Default-Button-on-a-User-Control
        protected override bool ProcessKeyPreview(ref Message m)
        {
            if (m.Msg == 0x100)//WM_KEYDOWN
            {
                if (m.WParam.ToInt32() == (int)ConsoleKey.Enter)
                    OnEnterPressed();
            }

            return base.ProcessKeyPreview(ref m);
        }

        //-///////////////////////////////////////////////////////////////////////
        //-///////////////////////////////////////////////////////////////////////

        protected virtual void OnEnterPressed()
        {
            if (EnterPressed != null)
                EnterPressed(this, EventArgs.Empty);
        }

        //-///////////////////////////////////////////////////////////////////////
        //-///////////////////////////////////////////////////////////////////////
    }

    //-///////////////////////////////////////////////////////////////////////
    //-///////////////////////////////////////////////////////////////////////
}
